from httpseeker.utils.encryption_filter import EncryptionFilter
import json


# ÂÖ®Â±ÄÂä†ÂØÜÂØÜÈí•Ôºà32Â≠óËäÇÔºâ
ENCRYPTION_KEY = "your-32-byte-secure-aes-key-1234"


def encrypt_request(request_body):
    """
    Âä†ÂØÜËØ∑Ê±Ç‰Ωì

    Args:
        request_body: ËØ∑Ê±Ç‰ΩìÊï∞ÊçÆÔºàdict Êàñ strÔºâ

    Returns:
        dict: Âä†ÂØÜÂêéÁöÑËØ∑Ê±Ç‰ΩìÔºåÊ†ºÂºè‰∏∫ {"data": "Âä†ÂØÜÂ≠óÁ¨¶‰∏≤"}
    """
    print("=" * 70)
    print("üîê Âä†ÂØÜËØ∑Ê±Ç")
    print("=" * 70)
    print(f"ÂéüÂßãËØ∑Ê±Ç:\n{json.dumps(request_body, ensure_ascii=False, indent=2)}")

    encryption_filter = EncryptionFilter(encryption_enabled=True, encryption_key=ENCRYPTION_KEY)
    encrypted_body, headers = encryption_filter.encrypt_request_body(request_body)

    print(f"\nÂä†ÂØÜÂêéÁöÑËØ∑Ê±Ç:\n{json.dumps(encrypted_body, ensure_ascii=False, indent=2)}")
    print("=" * 70 + "\n")
    return encrypted_body


def decrypt_response(response_data):
    """
    Ëß£ÂØÜÂìçÂ∫îÊï∞ÊçÆ

    Args:
        response_data: ÂìçÂ∫îÊï∞ÊçÆÔºàdictÔºâÔºåÂåÖÂê´Âä†ÂØÜÁöÑdataÂ≠óÊÆµ

    Returns:
        dict: Ëß£ÂØÜÂêéÁöÑÂìçÂ∫îÊï∞ÊçÆ
    """
    print("=" * 70)
    print("üîì Ëß£ÂØÜÂìçÂ∫î")
    print("=" * 70)
    print(f"Âä†ÂØÜÁöÑÂìçÂ∫î:\n{json.dumps(response_data, ensure_ascii=False, indent=2)}")

    encryption_filter = EncryptionFilter(encryption_enabled=True, encryption_key=ENCRYPTION_KEY)
    decrypted_data = encryption_filter.decrypt_response_data(response_data)

    print(f"\nËß£ÂØÜÂêéÁöÑÂìçÂ∫î:\n{json.dumps(decrypted_data, ensure_ascii=False, indent=2)}")
    print("=" * 70 + "\n")
    return decrypted_data


# ‰ΩøÁî®Á§∫‰æã
if __name__ == "__main__":
    # Âä†ÂØÜ‰æãÂ≠ê
    data = {
        "data": "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",
    }
    decrypt_response(data)
    # data = {
    # "code": 20000,
    # "msg": "success",
    # "data": "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",
    # "success": "true"
    # }
    # decrypt_response(data)






