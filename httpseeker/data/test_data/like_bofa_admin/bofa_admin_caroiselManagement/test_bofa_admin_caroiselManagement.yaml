# 点赞博发web站点登录后默认API测试用例集合
config:
  allure:
    epic: "对bofa_admin后台管理系统中轮播图管理CaroiselManagement的测试场景进行相关api接口触发业务校验"
    feature: "admin后台管理系统中 轮播图管理CaroiselManagement"
    story: "默认API接口测试"
    severity: "critical"

  request:
    env: "like_bofa_admin_test.env"  # 需要在run_env目录下创建qat.env文件
    headers:
      Content-Type: "application/json"
    timeout: 30
    verify: false
    encryption_enabled: false
    encryption_key: "your-32-byte-secure-aes-key-1234"  # 32字节的AES密钥

  module: "default_apis_test"

test_steps:
  - name: "测试调用account_encryptionEnabled接口"
    case_id: "bofa_admin_account_encryptionEnabled_001"
    description: "验证测试获取bofa_admin_account_encryptionEnabled"

    request:
      method: "GET"
      url: "/cdb/account/encryptionEnabled"
      params: null
      headers: null
      cookies: null
      body_type: null
      body: null
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

  - name: "测试调用account_login接口"
    case_id: "bofa_admin_account_login_001"
    description: "验证测试获取bofa_admin_account_login 并获取后台登录后生成的token用于后续其他测试场景"

    request:
      method: "POST"
      url: "/cdb/account/login"
      params: null
      headers: null
      cookies: null
      body_type: "json"
      body:
        username: "tiger"  # 后台登录账号
        password: "O4zAs9Mz4aoYOirIST4Xyg==" # 后台登录密码
        ggcode: ""
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

      - assert:
            check: "验证返回响应data为不空"
            type: "not_eq"
            value: null
            jsonpath: "$.json.data"

      - extract:
          key: "authorization_admin_token"
          type: "cache"
          jsonpath: "$.json.data.token"

  - name: "测试调用轮播图记录列表 dzbanner_list接口"
    case_id: "bofa_admin_dzbanner_list_001"
    description: "验证测试获取bofa_admin_dzbanner_list 查询轮播图列表记录"

    request:
      method: "GET"
      url: "/cdb/dzsys/dzbanner/list"
      params:
        page: 1
        limit: 20
      headers:
        authorization: "${authorization_admin_token}"
      cookies: null
      body_type: null
      body: null
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

      - assert:
          check: "验证返回响应中data内容返回记录数不为0"
          type: "not_eq"
          value: 0
          jsonpath: "$.json.data.total"

  - name: "测试调用轮播图添加新增记录接口"
    case_id: "bofa_admin_dzbanner_add_001"
    description: "验证测试调用bofa_admin_dzbanner_add_001 添加新增记录接口"

    request:
      method: "POST"
      url: "/cdb/dzsys/dzbanner"
      params: null
      headers:
        authorization: "${authorization_admin_token}"
      cookies: null
      body_type: "json"
      body:
        id: ""
        idw: ""
        image: "https://8xzlef11.oss-cn-hongkong.aliyuncs.com/aly/20251111/2bce769ca6b1439daf695e7c0447d06fapi_202"
        bannerType: 1
        jumpLink: "https://sea1outmovieadmin.ye81s.com/dzsys/dzbanner/list"
        sortOrder: 3
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

  - name: "测试调用轮播图记录列表 dzbanner_list接口 先查询获取第一条记录提取信息作为修改记录"
    case_id: "bofa_admin_dzbanner_getFristRecord_002"
    description: "验证测试获取bofa_admin_dzbanner_getFristRecord_002 查询轮播图列表记录 获取第一条记录提取信息作为修改记录"

    request:
      method: "GET"
      url: "/cdb/dzsys/dzbanner/list"
      params:
        page: 1
        limit: 20
      headers:
        authorization: "${authorization_admin_token}"
      cookies: null
      body_type: null
      body: null
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

      - assert:
          check: "验证返回响应中data内容不为空--(若无记录时不知道是否为空，后面再验证)"
          type: "not_eq"
          value: null
          jsonpath: "$.json.data"

      - extract:
          key: "first_dzbanner_record_id"
          type: "cache"
          jsonpath: "$.json.data.records[0].id"
      - extract:
          key: "first_dzbanner_record_idw"
          type: "cache"
          jsonpath: "$.json.data.records[0].idw"
      - extract:
          key: "first_dzbanner_record_OldBannerType"
          type: "cache"
          jsonpath: "$.json.data.records[0].bannerType"
      - extract:
          key: "first_dzbanner_record_oldModifyTime"
          type: "cache"
          jsonpath: "$.json.data.records[0].modifyTime"
      - extract:
          key: "first_dzbanner_record_oldimage"
          type: "cache"
          jsonpath: "$.json.data.records[0].image"

  - name: "测试调用修改第一条轮播图记录dzbanner接口"
    case_id: "bofa_admin_dzbanner_modify_001"
    description: "验证测试调用修改第一条轮播图记录dzbanner接口 修改bannerType类型为0已禁用 sortOrder=5"

    request:
      method: "PUT"
      url: "/cdb/dzsys/dzbanner"
      params: null
      headers:
        authorization: "${authorization_admin_token}"
      cookies: null
      body_type: "json"
      body:
        id: "${first_dzbanner_record_id}"
        idw: "${first_dzbanner_record_idw}"
        image: "${first_dzbanner_record_oldimage}"
        bannerType: 0
        jumpLink: "https://www.baidu.com"
        sortOrder: 5
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

  - name: "测试调用删除第一条轮播图记录dzbanner接口"
    case_id: "bofa_admin_dzbanner_delete_001"
    description: "验证测试调用删除第一条轮播图记录dzbanner接口"

    request:
      method: "DELETE"
      url: "/cdb/dzsys/dzbanner"
      params:
        id: "${first_dzbanner_record_id}"
      headers:
        authorization: "${authorization_admin_token}"
      cookies: null
      body_type: null
      body: null
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

  - name: "测试调用查询dzbanner的 查询轮播图类型 "
    case_id: "bofa_admin_dzbanner_typeQuery_001"
    description: "验证测试dzbanner_typeQuery_001 查询轮播图类型 "

    request:
      method: "GET"
      url: "/cdb/dict/getDicts/%E8%BD%AE%E6%92%AD%E5%9B%BE%E7%B1%BB%E5%9E%8B"
      params: null
      headers:
        authorization: "${authorization_admin_token}"
      cookies: null
      body_type: null
      body: null
      files: null

    teardown:
      - assert:
          check: "验证请求成功--code"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回响应成功标识--msg"
          type: "eq"
          value: "success"
          jsonpath: "$.json.msg"

      - assert:
          check: "验证返回响应中data不为空"
          type: "not_eq"
          value: null
          jsonpath: "$.json.data"

#     上传图片暂时先不实现  新增接口中直接使用图片的URL替代
#  - name: "测试调用轮播图上传图片信息 dzbanner_upImageFileToSys接口"
#    case_id: "bofa_admin_dzbanner_upImageFileToSys_001"
#    description: "验证测试调用bofa_admin_dzbanner_upImageFileToSys_001 上传轮播图记录中图片文件"
#
#    request:
#      method: "POST"
#      url: "/cdb/sys/file/info"
#      params:
#        page: 1
#        limit: 20
#      headers:
#        authorization: "${authorization_admin_token}"
#      cookies: null
#      body_type: "form-data"
#      files:
#        'file': ('FO002.jpg', '', 'image/jpeg'),
#
#    teardown:
#      - assert:
#          check: "验证请求成功--code"
#          type: "eq"
#          value: 20000
#          jsonpath: "$.json.code"
#
#      - assert:
#          check: "验证返回响应成功标识--msg"
#          type: "eq"
#          value: "success"
#          jsonpath: "$.json.msg"
#
#      - assert:
#          check: "验证返回响应中data内容不为空--(若无记录时不知道是否为空，后面再验证)"
#          type: "not_eq"
#          value: null
#          jsonpath: "$.json.data"
#
#      - extract:
#          key: "new_dzbanner_file_id"
#          type: "cache"
#          jsonpath: "$.json.data.id"
#      - extract:
#          key: "new_dzbanner_file_url"
#          type: "cache"
#          jsonpath: "$.json.data.url"
