# bofa站点admin后台-余额宝-余额信息
config:
  allure:
    epic: "bofa站点admin后台"
    feature: "余额宝_余额信息"
    story: "页面所有数据接口"
    severity: "critical"

  request:
    env: "Dz_like_bofa_admin.env"
    headers:
      Content-Type: "application/json"
    timeout: 30
    verify: false

  module: "yuebao_balInfo"

test_steps:
  # ========== 步骤1: 余额宝模块-余额信息子模块-查询用户列表==========
  - name: "查询用户列表"
    case_id: "cdb_bofa_yuebao_balInfo_001"
    description: "余额宝模块-余额信息子模块-查询用户列表，提取用户ID"

    request:
      method: "GET"
      url: "/cdb/dzuser/user/getPartList?page=1&limit=10&str=&dzstatus=&vipType=&expVipType=&userType=1&registerIp=&lastIp=&levels=0&expireTimes=&expireTimee=&expStartTime=&expEndTime=&sourceInvitationCode=&walletAddress=&gmt=&countryCodeNumber=&realName=&lastIpCity=&email="
      params: null
      headers: null
      cookies: null
      body_type: null
      body: null
      files: null

    teardown:
      - assert:
          check: "验证请求成功"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回成功标识"
          type: "eq"
          value: true
          jsonpath: "$.json.success"

      - assert:
          check: "验证data不为空"
          type: "not_eq"
          value: null
          jsonpath: "$.json.data"

      - extract:
          key: "uid"
          type: "cache"
          jsonpath: "$.json.data.records[0].id"

  # ========== 步骤2: 余额宝模块-余额信息子模块-上分==========
  - name: "上分"
    case_id: "cdb_bofa_yuebao_balInfo_002"
    description: "余额宝模块-余额信息子模块-上分（20000）"

    request:
      method: "POST"
      url: "/cdb/dzuser/user/straightBuckle"
      params: null
      headers:
        X-Safe-Password: "${get_google_auth_code(action)}"
        X-Safe-Money: "20000"
      cookies: null
      body_type: "json"
      body:
        "money": "20000"
        "type": 1
        "uid": ${uid}
        "remark": ""
      files: null

    teardown:
      - assert:
          check: "验证请求成功"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回成功标识"
          type: "eq"
          value: true
          jsonpath: "$.json.success"

  # ========== 步骤3: 余额宝模块-余额信息子模块-下分==========
  - name: "下分"
    case_id: "cdb_bofa_yuebao_balInfo_003"
    description: "余额宝模块-余额信息子模块-下分（1000）"

    request:
      method: "POST"
      url: "/cdb/dzuser/user/straightBuckle"
      params: null
      headers:
        X-Safe-Password: "${get_google_auth_code(action)}"
      cookies: null
      body_type: "json"
      body:
        "money": "1000"
        "type": 2
        "uid": ${uid}
        "remark": ""
      files: null

    teardown:
      - assert:
          check: "验证请求成功"
          type: "eq"
          value: 20000
          jsonpath: "$.json.code"

      - assert:
          check: "验证返回成功标识"
          type: "eq"
          value: true
          jsonpath: "$.json.success"
